import{N as b,L as V,p as C,m as z,v as r,T as A,P as g,Q as L,e as B,A as Z,q,M as Q,K as J,R as W,F as X,x as ee}from"./vendor.006c88a1.js";import{n as w,t as y,u as j,v as oe,x as te,y as E,c as T,e as D,k as ne,i as _,z as ae,w as R,m as k,A as se}from"./base.8cd46ad1.js";import{u as ce,I as le}from"./index.5a3fded9.js";import{u as re}from"./use-touch.abe69874.js";import{u as $}from"./use-lazy-render.f7e708c4.js";import{P as ie,c as ue}from"./on-popup-reopen.15a0f405.js";import{H as de}from"./constant.50ba7d8c.js";const K={show:Boolean,zIndex:w,overlay:y,duration:w,teleport:[String,Object],lockScroll:y,lazyRender:y,beforeClose:Function,overlayStyle:Object,overlayClass:j,transitionAppear:Boolean,closeOnClickOverlay:y},Ae=Object.keys(K);let h=0;const M="van-overflow-hidden";function fe(e,o){const s=re(),c=i=>{s.move(i);const x=s.deltaY.value>0?"10":"01",P=te(i.target,e.value),{scrollHeight:u,offsetHeight:I,scrollTop:v}=P;let f="11";v===0?f=I>=u?"00":"01":v+I>=u&&(f="10"),f!=="11"&&s.isVertical()&&!(parseInt(f,2)&parseInt(x,2))&&E(i,!0)},n=()=>{document.addEventListener("touchstart",s.start),document.addEventListener("touchmove",c,{passive:!1}),h||document.body.classList.add(M),h++},a=()=>{h&&(document.removeEventListener("touchstart",s.start),document.removeEventListener("touchmove",c),h--,h||document.body.classList.remove(M))},l=()=>o()&&n(),d=()=>o()&&a();oe(l),b(d),V(d),C(o,i=>{i?n():a()})}const[ve,me]=T("overlay"),ye={show:Boolean,zIndex:w,duration:w,className:j,lockScroll:y,customStyle:Object};var he=z({name:ve,props:ye,setup(e,{slots:o}){const s=$(()=>e.show),c=a=>{E(a,!0)},n=s(()=>{var a;const l=D(ne(e.zIndex),e.customStyle);return _(e.duration)&&(l.animationDuration=`${e.duration}s`),g(r("div",{style:l,class:[me(),e.className],onTouchmove:e.lockScroll?c:ae},[(a=o.default)==null?void 0:a.call(o)]),[[L,e.show]])});return()=>r(A,{name:"van-fade",appear:!0},{default:n})}});const Pe=R(he),Ie=D({},K,{round:Boolean,position:k("center"),closeIcon:k("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:k("top-right"),safeAreaInsetBottom:Boolean}),[pe,N]=T("popup");let F=2e3;var we=z({name:pe,inheritAttrs:!1,props:Ie,emits:["open","close","opened","closed","update:show","click-overlay","click-close-icon"],setup(e,{emit:o,attrs:s,slots:c}){let n,a;const l=B(),d=B(),i=$(()=>e.show||!e.lazyRender),x=Z(()=>{const t={zIndex:l.value};if(_(e.duration)){const m=e.position==="center"?"animationDuration":"transitionDuration";t[m]=`${e.duration}s`}return t}),P=()=>{n||(e.zIndex!==void 0&&(F=+e.zIndex),n=!0,l.value=++F,o("open"))},u=()=>{n&&ue(e.beforeClose,{done(){n=!1,o("close"),o("update:show",!1)}})},I=t=>{o("click-overlay",t),e.closeOnClickOverlay&&u()},v=()=>{if(e.overlay)return r(Pe,{show:e.show,class:e.overlayClass,zIndex:l.value,duration:e.duration,customStyle:e.overlayStyle,onClick:I},{default:c["overlay-content"]})},f=t=>{o("click-close-icon",t),u()},H=()=>{if(e.closeable)return r(le,{role:"button",tabindex:0,name:e.closeIcon,class:[N("close-icon",e.closeIconPosition),de],classPrefix:e.iconPrefix,onClick:f},null)},Y=()=>o("opened"),G=()=>o("closed"),U=i(()=>{var t;const{round:m,position:p,safeAreaInsetBottom:S}=e;return g(r("div",ee({ref:d,style:x.value,class:[N({round:m,[p]:p}),{"van-safe-area-bottom":S}]},s),[(t=c.default)==null?void 0:t.call(c),H()]),[[L,e.show]])}),O=()=>{const{position:t,transition:m,transitionAppear:p}=e,S=t==="center"?"van-fade":`van-popup-slide-${t}`;return r(A,{name:m||S,appear:p,onAfterEnter:Y,onAfterLeave:G},{default:U})};return C(()=>e.show,t=>{t&&!n&&P(),!t&&n&&(n=!1,o("close"))}),ce({popupRef:d}),fe(d,()=>e.show&&e.lockScroll),se("popstate",()=>{e.closeOnPopstate&&(u(),a=!1)}),q(()=>{e.show&&P()}),Q(()=>{a&&(o("update:show",!0),a=!1)}),b(()=>{e.show&&(u(),a=!0)}),J(ie,()=>e.show),()=>e.teleport?r(W,{to:e.teleport},{default:()=>[v(),O()]}):r(X,null,[v(),O()])}});const ge=R(we);export{ge as P,Ae as a,K as p};
