import{c as E,l as L,m as j,t as w,D as C,A as R,h as v,E as B,w as N}from"./base.8cd46ad1.js";import{u as V}from"./index.5a3fded9.js";import{u as _}from"./use-tab-status.aafe5ade.js";import{L as q}from"./index.adda227c.js";import{m as y,e as h,p as T,V as z,q as A,v as i,z as D}from"./vendor.006c88a1.js";const[F,o,H]=E("list"),I={error:Boolean,offset:L(300),loading:Boolean,finished:Boolean,errorText:String,direction:j("down"),loadingText:String,finishedText:String,immediateCheck:w};var M=y({name:F,props:I,emits:["load","update:error","update:loading"],setup(e,{emit:c,slots:a}){const d=h(!1),f=h(),m=h(),s=_(),g=C(f),n=()=>{D(()=>{if(d.value||e.finished||e.error||(s==null?void 0:s.value)===!1)return;const{offset:t,direction:l}=e,r=v(g);if(!r.height||B(f))return;let u=!1;const x=v(m);l==="up"?u=r.top-x.top<=t:u=x.bottom-r.bottom<=t,u&&(d.value=!0,c("update:loading",!0),c("load"))})},b=()=>{if(e.finished){const t=a.finished?a.finished():e.finishedText;if(t)return i("div",{class:o("finished-text")},[t])}},k=()=>{c("update:error",!1),n()},P=()=>{if(e.error){const t=a.error?a.error():e.errorText;if(t)return i("div",{role:"button",class:o("error-text"),tabindex:0,onClick:k},[t])}},S=()=>{if(d.value&&!e.finished)return i("div",{class:o("loading")},[a.loading?a.loading():i(q,{class:o("loading-icon")},{default:()=>[e.loadingText||H("loading")]})])};return T(()=>[e.loading,e.finished,e.error],n),s&&T(s,t=>{t&&n()}),z(()=>{d.value=e.loading}),A(()=>{e.immediateCheck&&n()}),V({check:n}),R("scroll",n,{target:g}),()=>{var t;const l=(t=a.default)==null?void 0:t.call(a),r=i("div",{ref:m,class:o("placeholder")},null);return i("div",{ref:f,role:"feed",class:o(),"aria-busy":d.value},[e.direction==="down"?l:r,S(),b(),P(),e.direction==="up"?l:r])}}});const Q=N(M);export{Q as L};
